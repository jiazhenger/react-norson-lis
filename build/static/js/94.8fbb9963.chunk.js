(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[94],{336:function(e,t,s){"use strict";t.a=s.p+"static/media/saoma.aa9fee90.svg"},423:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return C}));var n=s(5),a=s(6),c=s(22),r=s(23),i=s(27),l=s(25),o=s(24),u=s(0),h=s.n(u),d=s(336),m=window,p=m.$http,f=m.$fn,b=m.$async,j=b((function(){return Promise.all([s.e(0),s.e(2),s.e(1),s.e(3),s.e(13)]).then(s.bind(null,94))})),_=Promise.all([s.e(0),s.e(2),s.e(1),s.e(14)]).then(s.bind(null,123)),g=Promise.all([s.e(0),s.e(2),s.e(1),s.e(3),s.e(22)]).then(s.bind(null,143)),y=b((function(){return Promise.all([s.e(0),s.e(30)]).then(s.bind(null,204))})),v=b((function(){return Promise.all([s.e(0),s.e(2),s.e(1),s.e(3),s.e(17)]).then(s.bind(null,146))})),x=b((function(){return Promise.all([s.e(0),s.e(2),s.e(1),s.e(12),s.e(19)]).then(s.bind(null,170))})),O=b((function(){return s.e(27).then(s.bind(null,335))})),k=b((function(){return Promise.all([s.e(0),s.e(1),s.e(4),s.e(11)]).then(s.bind(null,133))})),C=function(e){Object(l.a)(s,e);var t=Object(o.a)(s);function s(){var e;Object(c.a)(this,s);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={data:[],pag:{},selectedKeys:[],forms:{},keys:0,spec_code:"",sf_number:"",project_name:"",isPrinter:!1,copies:1,shortKeyParams:""},e.forms=[],e.copiesSelect=[{label:"1",value:1},{label:"2",value:2},{label:"3",value:3}],e.model={},e.fetch=function(t){return f.fetch.call(Object(i.a)(e),"shelf/upshelflist",t)},e.cols=[{title:"\u5e8f\u53f7",field:"sort",width:100},{title:"\u6807\u672c\u53f7",field:"spec_code",width:120},{title:"\u6807\u672c\u67b6\u7f16\u53f7",field:"sf_number",width:120},{title:"\u5c97\u4f4d\u7ec4",field:"project_name",width:120}],e.onChanges=function(t,s){var n=e.state[s];n=t,e.setState(Object(a.a)({},s,n))},e.entering=function(){var t={spec_code:e.state.spec_code};p.submit(Object(i.a)(e),"shelf/alertsplit",{param:t,loading:!1}).then((function(t){if("1"===t.alert_split){var s=t.project_names?t.project_names:"";e.setState({shortKeyParams:t.old_spec_code}),g.then((function(n){n.default({msg:"\u662f\u5426\u76f4\u63a5\u62c6\u5206\uff1f".concat(s),onOk:function(s){e.splits(t.old_spec_code),e.setState({shortKeyParams:""}),s()},onCancel:function(t){console.log(t),e.UpperFrameEntry(),e.setState({shortKeyParams:""})}})}))}else e.UpperFrameEntry()})).catch((function(t){e.setState({sf_number:"",project_name:"",keys:e.state.keys+1})}))},e.UpperFrameEntry=function(){var t={spec_code:e.state.spec_code};p.submit(Object(i.a)(e),"shelf/getshelf",{param:t,loading:!1}).then((function(t){e.setState({sf_number:t.sf_number,project_name:t.project_name,keys:e.state.keys+1});var s={sf_number:e.state.sf_number,project_name:e.state.project_name,spec_code:e.state.spec_code};p.submit(Object(i.a)(e),"shelf/upshelf",{param:s}).then((function(t){_.then((function(e){return e.default.success("\u64cd\u4f5c\u6210\u529f")})),e.printers(e.state.spec_code),e.setState({spec_code:"",keys:e.state.keys+1}),e.fetch(),e.props.onEntering()}))})).catch((function(t){e.setState({sf_number:"",project_name:"",keys:e.state.keys+1})}))},e.printers=function(t){if(e.state.isPrinter){var s={spec_code:t};p.submit(Object(i.a)(e),"shelf/printshelf",{param:s}).then((function(e){}))}},e}return Object(r.a)(s,[{key:"componentDidMount",value:function(){this.props.onRef(this),this.fetch()}},{key:"splits",value:function(e){var t=this,s={old_spec_code:e};p.submit(this,"shelf/autosplit",{param:s}).then((function(s){_.then((function(e){return e.default.success("\u64cd\u4f5c\u6210\u529f")})),t.printers(e),t.setState({spec_code:"",keys:t.state.keys+1}),t.fetch(),t.props.onEntering()})).catch((function(e){t.setState({sf_number:"",project_name:"",keys:t.state.keys+1})}))}},{key:"render",value:function(){var e=this,t=this.state,s=t.data,a=t.pullLoading,c=t.pag,r=t.keys;return Object(n.jsxs)(h.a.Fragment,{children:[Object(n.jsxs)("div",{className:"fx p10",children:[Object(n.jsxs)("div",{className:"ex fxw",children:[Object(n.jsxs)("div",{className:"mb5 mr10 fxm",children:["\u6807\u672c\u53f7\uff1a",Object(n.jsx)(v,{p:"\u8bf7\u8f93\u5165\u6807\u672c\u53f7",width:120,value:this.state.spec_code,style:{borderRadius:"4px"},className:"mlr5",onChange:function(t){return e.onChanges(t,"spec_code")},onPressEnter:function(){return e.entering()}}),Object(n.jsx)(O,{className:"mr15 dkm",src:d.a,height:"20px",width:"20px"})]}),Object(n.jsxs)("div",{className:"mb5 mr10",children:["\u6807\u672c\u67b6\u7f16\u53f7\uff1a",Object(n.jsx)(v,{p:"\u8bf7\u8f93\u5165\u6807\u672c\u67b6\u7f16\u53f7",disabled:!0,width:120,value:this.state.sf_number,style:{borderRadius:"4px"},className:"mlr5",onChange:function(t){return e.onChanges(t,"sf_number")}})]}),Object(n.jsxs)("div",{className:"mb5 mr10",children:["\u5c97\u4f4d\u7ec4\uff1a",Object(n.jsx)(v,{p:"\u8bf7\u8f93\u5165\u5c97\u4f4d\u7ec4",disabled:!0,width:120,value:this.state.project_name,style:{borderRadius:"4px"},className:"mlr5",onChange:function(t){return e.onChanges(t,"project_name")}})]}),Object(n.jsxs)("div",{className:"mb5 mr10 fxm",children:[Object(n.jsx)(y,{value:this.state.isPrinter,onChange:function(t){return e.onChanges(t,"isPrinter")}}),Object(n.jsx)("span",{className:"ml5",children:"\u6253\u5370\u5b9e\u9a8c\u53f7"})]}),this.state.isPrinter&&Object(n.jsxs)("div",{className:"mb5 mr10 fxm",children:["\u6253\u5370\u4efd\u6570\uff1a",Object(n.jsx)(x,{data:this.copiesSelect,p:"\u8bf7\u9009\u62e9",nameStr:"label",idStr:"value",value:this.state.copies,onChanged:function(t){return e.onChanges(t,"copies")},width:80,style:{borderRadius:"4px"}})]})]},r),Object(n.jsxs)("div",{children:[Object(n.jsx)(j,{label:"\u5f55\u5165",ghost:!0,className:"mr10",onClick:function(){return e.entering()}}),Object(n.jsx)(j,{label:"\u67e5\u770b\u5168\u90e8",ghost:!0,onClick:function(){return e.fetch()}})]})]}),Object(n.jsx)(k,{className:"plr2",cols:this.cols,data:s,loading:a,onRow:function(t){return e.setState({selectedKeys:t})},pag:c,onChange:function(t,s){return f.pageChange.call(e,{current:t,pageSize:s})}})]})}}]),s}(h.a.Component)}}]);
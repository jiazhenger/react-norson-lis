(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[249],{290:function(t,e,a){"use strict";var n=a(2),c=a(1),o=function(t){return(t=t.toString())[1]?t:"0"+t},l=function(t,e){return t.map(o).join(e)};e.a={full:function(t){var e=new Date(t);return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds()}},format:function(t,e){var a=Object(n.a)({s:"-",l:"en",t:"ymd"},e),o=null,i=null;if(i=c.a.isString(t)?this.getTime(t):t instanceof Date?t.getTime():t){var s=this.full(i);switch(a.t){case"full":o=l([s.year,s.month,s.day],a.s)+" "+l([s.h,s.m,s.s],":");break;case"ymd-hm":o=l([s.year,s.month,s.day],a.s)+" "+l([s.h,s.m],":")+":00";break;case"ymd":o="zh"===a.l?s.year+"\u5e74"+s.month+"\u6708"+s.day+"\u65e5":l([s.year,s.month,s.day],a.s);break;case"hms":o=l([s.h,s.m,s.s],":");break;case"hm":o=l([s.h,s.m],":")}}return o},getTime:function(t){return t?new Date(t).getTime():(new Date).getTime()},customDate:function(t,e,a){var n=new Date,c=n.getFullYear(),o=n.getMonth()+1>9?n.getMonth()+1:"0".concat(n.getMonth()+1),l=n.getDate()>9?n.getDate():"0".concat(n.getDate()),i=n.getHours()>9?n.getHours():"0".concat(n.getHours()),s=n.getMinutes()>9?n.getMinutes():"0".concat(n.getMinutes()),r=n.getSeconds()>9?n.getSeconds():"0".concat(n.getSeconds()),u="";if(1===t){var d=l-t>9?l-t:"0".concat(l-t);u=a?"".concat(c,"-").concat(o,"-").concat(d," ").concat(a):"start"===e?"".concat(c,"-").concat(o,"-").concat(d," 00:00:00"):"end"===e?"".concat(c,"-").concat(o,"-").concat(d," 23:59:59"):"".concat(c,"-").concat(o,"-").concat(d," ").concat(i,":").concat(s,":").concat(r)}else u=2===t?"date"===e?"".concat(c,"-").concat(o,"-01"):"".concat(c,"-").concat(o,"-01 00:00:00"):3===t?"date"===e?"".concat(c,"-").concat(o-1,"-").concat(l):"".concat(c,"-").concat(o-1,"-").concat(l," 00:00:00"):"current-date"===t?"".concat(c,"-").concat(o,"-").concat(l):"".concat(c,"-").concat(o,"-").concat(l," ").concat(i,":").concat(s,":").concat(r);return u}}},538:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return C}));var n=a(5),c=a(2),o=a(22),l=a(23),i=a(27),s=a(25),r=a(24),u=a(0),d=a.n(u),h=a(290),m=window,f=m.$http,b=m.$fn,g=m.$async,p=Promise.all([a.e(0),a.e(2),a.e(1),a.e(14)]).then(a.bind(null,123)),y=Promise.all([a.e(0),a.e(2),a.e(1),a.e(3),a.e(22)]).then(a.bind(null,143)),_=a.e(9).then(a.bind(null,144)),w=g((function(){return a.e(5).then(a.bind(null,135))})),j=g((function(){return Promise.all([a.e(0),a.e(2),a.e(1),a.e(3),a.e(82)]).then(a.bind(null,434))})),v=g((function(){return a.e(6).then(a.bind(null,137))})),S=g((function(){return Promise.all([a.e(0),a.e(1),a.e(4),a.e(11)]).then(a.bind(null,133))})),C=function(t){Object(s.a)(a,t);var e=Object(r.a)(a);function a(){var t;Object(o.a)(this,a);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return(t=e.call.apply(e,[this].concat(l))).state={data:[],pag:{},selectedKeys:[],btns:[],dataList:[]},t.billStatusOption=[{label:"\u8d22\u52a1\u5f85\u5ba1\u6838",value:"45301"},{label:"\u8d22\u52a1\u5f85\u7ed3\u7b97",value:"45302"},{label:"\u8d22\u52a1\u5df2\u7ed3\u7b97",value:"45303"},{label:"\u5df2\u4f5c\u5e9f",value:"45304"},{label:"\u4e1a\u52a1\u5458\u5f85\u5ba1\u6838",value:"45305"}],t.model={start_at:h.a.customDate(2,"date"),end_at:h.a.customDate("current-date")},t.forms=[{label:"\u63a5\u6536\u6807\u672c\u65f6\u95f4",name:"date",type:"date-range",names:["start_at","end_at"]},{label:"\u5ba2\u6237\u540d\u79f0",name:"hosp_id",type:"select",data:[]},{label:"\u5b9e\u9a8c\u79d1\u5ba4",name:"project_parent_id",type:"select",data:[]},{label:"\u533a\u57df",name:"region_id",type:"select",data:[]},{label:"\u4e1a\u52a1\u5458",name:"salesman_id",type:"select",data:[]},{label:"\u72b6\u6001",name:"status",type:"select",data:t.billStatusOption,nameStr:"label",idStr:"value"}],t.fetch=function(e){return f.paging(Object(i.a)(t),"bill-st/constsummary",{param:Object(c.a)(Object(c.a)({},e),{},{pageSize:t.pageSize},t.model),loading:!1})},t.cols=[{title:"\u5e8f\u53f7",field:"sort",width:80},{title:"\u5c97\u4f4d",field:"project_name",width:130},{title:"\u5ba2\u6237\u540d\u79f0",field:"hosp_name",width:160},{title:"\u81ea\u7136\u9879\u76ee",field:"parent_kind_name",width:160},{title:"\u6570\u91cf",field:"sum_spec_in",width:80},{title:"\u51b2\u62b5\u6570\u91cf",field:"sum_spec_out",width:80},{title:"\u5b9e\u9645\u6570\u91cf",field:"sum_spec",width:80},{title:"\u6807\u51c6\u4ef7\u683c",field:"sum_sprice",width:100},{title:"\u5b9e\u9645\u4ef7\u683c",field:"sum_price",width:100},{title:"\u5b9e\u9a8c\u79d1\u5ba4",field:"project_parent_name",width:100},{title:"\u5f00\u7968\u5355\u4f4d(NC)",field:"organization_name",width:100},{title:"\u5f00\u7968\u5355\u4f4d\u7f16\u7801(NC)",field:"organization_code",width:130},{title:"\u4e1a\u52a1\u5458",field:"salesman_user",width:100},{title:"\u4e1a\u52a1\u539f\u7f16\u7801",field:"salesman_code",width:100},{title:"\u533a\u57df",field:"region_name",width:100},{title:"\u533a\u57df\u7f16\u7801",field:"region_num",width:100}],t.ButtonGroup=function(){return[{label:"\u5bfc\u51faF1",code:"F1",onClick:function(){console.log(Object(i.a)(t)),y.then((function(e){e.default({msg:"\u662f\u5426\u5bfc\u51fa\u8d26\u5355?",onOk:function(e){var a={export:1,start_at:t.model.start_at,end_at:t.model.end_at};f.submit(null,"bill-st/constsummary",{param:a}).then((function(a){p.then((function(t){return t.default.success("\u5bfc\u51fa\u6210\u529f")})),console.log(a),window.location.href=a.url,t.fetch(t.model),e()}))}})}))}}]},t}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var t=this;_.then((function(e){var a=e.default;b.getCache({cache:a.BsHospitalSelect,callback:function(e){b.hasArray(e)?t.forms[1].data=e:f.submit(null,"bs-hospital/select").then((function(e){t.forms[1].data=e,b.setCache()}))}}),b.getCache({cache:a.ProjectTeamMenuSelect,callback:function(e){b.hasArray(e)?t.forms[2].data=e:f.submit(null,"project-team/selectMenu").then((function(e){t.forms[2].data=e,b.setCache()}))}}),b.getCache({cache:a.bsareaSelect,callback:function(e){b.hasArray(e)?t.forms[3].data=e:f.submit(null,"bs-area/select").then((function(e){t.forms[3].data=e,b.setCache()}))}}),b.getCache({cache:a.bssalesmanSelect,callback:function(e){b.hasArray(e)?t.forms[4].data=e:f.submit(null,"bs-salesman/select").then((function(e){t.forms[4].data=e,b.setCache()}))}})})),this.fetch(this.model)}},{key:"render",value:function(){var t=this,e=this.state,a=e.data,c=e.dataList,o=e.pullLoading,l=e.pag;e.selectedKeys;return Object(n.jsxs)(w,{title:"\u6210\u672c\u6c47\u603b",ButtonGroup:this.ButtonGroup(),children:[Object(n.jsx)(v,{data:this.forms,onChange:function(e,a){return b.onChange.call(t,e,a)},onSubmit:b.onSubmit.bind(this),onReset:b.onReset.bind(this,this.forms),loading:o,init:function(t){t.setFieldsValue({date:[h.a.customDate(2,"date"),h.a.customDate("current-date")]})}}),Object(n.jsx)(S,{className:"xplr",cols:this.cols,data:a,loading:o,onRow:function(e){t.setState({dataList:e})},pag:l,onChange:function(e,a){return b.pageChange.call(t,{current:e,pageSize:a})}}),Object(n.jsx)(j,{rowdata:c||[],model:this.model})]})}}]),a}(d.a.Component)}}]);
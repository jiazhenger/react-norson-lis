(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[62],{364:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return y}));var n=a(5),l=a(2),s=a(22),o=a(23),u=a(27),c=a(25),i=a(24),r=a(0),p=a.n(r),d=window,m=d.$http,b=d.$fn,v=d.$async,h=Promise.all([a.e(0),a.e(2),a.e(1),a.e(14)]).then(a.bind(null,123)),f=v((function(){return a.e(7).then(a.bind(null,142))})),_=a.e(9).then(a.bind(null,144)),y=function(e){Object(c.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).statusOptions=[{label:"\u662f",value:"1"},{label:"\u5426",value:"2"},{label:"\u4e0d\u9700\u8981",value:"3"}],e.typeOptions=[{label:"\u6837\u672c\u4fe1\u606f\u548c\u7ed3\u679c\u6c9f\u901a",value:"1"},{label:"\u6837\u672c\u5371\u6025\u503c\u901a\u77e5",value:"2"},{label:"\u54a8\u8be2\u901a\u77e5",value:"3"},{label:"\u5176\u4ed6",value:"4"}],e.state={submit:[{label:"\u6807\u672c\u6761\u7801",name:"spec_code",required:!0,disabled:!0},{label:"\u9001\u68c0\u5355\u4f4d",name:"inspec_unit_id",type:"select",data:[],nameStr:"name",idStr:"value",required:!0},{label:"\u81ea\u7136\u9879\u76ee",name:"kind_name",type:"textarea",full:!0,width:"100%",disabled:!0},{label:"\u9001\u68c0\u79d1\u5ba4",name:"depart_name",required:!0},{label:"\u5c97\u4f4d",name:"major_group",type:"select",data:[],nameStr:"name",idStr:"value"},{label:"\u56de\u987e",name:"look_back",type:"select",data:e.statusOptions,nameStr:"label",idStr:"value"},{label:"\u6c9f\u901a\u7c7b\u578b",name:"type",type:"select",data:e.typeOptions,nameStr:"label",idStr:"value",required:!0},{label:"\u53cd\u9988\u4eba",name:"contact_user",required:!0},{label:"\u8054\u7cfb\u7535\u8bdd",name:"phone",required:!0},{label:"\u8054\u7cfb\u65e5\u671f",name:"contact_at",type:"date-time",required:!0},{label:"\u53cd\u9988\u5185\u5bb9",name:"inspec_content",type:"textarea",full:!0,width:"100%"},{label:"\u53cd\u9988\u539f\u56e0",name:"contact_reason",type:"textarea",full:!0,width:"100%"}]},e.model={},e.changeInfo=function(t){console.log("\u5ba2\u6237\u53cd\u9988\u8d4b\u503c"),e.clears();var a=e.state.submit;t.type?(a[0].value=t.rows.spec_code,a[1].value=t.rows.inspec_unit_id,a[2].value=t.rows.kind_name,a[3].value=t.rows.depart_name,a[4].value=t.rows.major_group,a[5].value=t.rows.look_back,a[6].value=t.rows.type,a[7].value=t.rows.contact_user,a[8].value=t.rows.phone,a[9].value=t.rows.contact_at,a[10].value=t.rows.inspec_content,a[11].value=t.rows.contact_reason,e.setState({submit:a})):t.rows.spec_code&&m.pull(Object(u.a)(e),"sp-customer-log/getInfoBySpec",{dataName:null,param:{spec_code:t.rows.spec_code}}).then((function(t){var n=t.spec_info;a[0].value=n.spec_code,a[4].value=n.major_group_id,a[1].value=n.inspec_unit_id,a[3].value=n.depart_name,a[2].value=n.kind_name,e.setState({submit:a})}))},e.submits=function(){console.log("\u5ba2\u6237\u53cd\u9988\u63d0\u4ea4"),e.form.submit()},e.clears=function(){console.log("\u5ba2\u6237\u53cd\u9988\u6e05\u7a7a");var t=e.state.submit;t.forEach((function(t){e.props.type?t.value="":"spec_code"===t.name||"kind_name"===t.name||(t.value="")})),e.setState({submit:t})},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.onRef(this);var t=this.state.submit;_.then((function(a){b.getCache({cache:a.default.BsHospitalSelect,name:"name",id:"value",callback:function(a){b.hasArray(a)?(t[1].data=a,e.setState({submit:t})):m.submit(null,"bs-hospital/select").then((function(a){t[1].data=a,e.setState({submit:t}),b.setCache()}))}}),b.getCache({cache:a.default.laboratoryselect,name:"name",id:"value",callback:function(a){b.hasArray(a)?(t[4].data=a,e.setState({submit:t})):m.submit(null,"project-team/laboratoryselect").then((function(a){t[4].data=a,e.setState({submit:t}),b.setCache()}))}})})),this.changeInfo(this.props)}},{key:"componentWillReceiveProps",value:function(e){e.rows!==this.props.rows&&this.changeInfo(e)}},{key:"render",value:function(){var e=this,t=this.state.submit;return Object(n.jsx)("div",{children:Object(n.jsx)(f,{modal:!0,data:t,display:!0,onChange:function(e,a,n){var l=n.name;t.forEach((function(t){t.name===l&&(t.value=e)}))},onSubmit:function(t){var a=Object(l.a)({},t),n="sp-customer-log/add",s="\u6dfb\u52a0";e.props.type&&(a=Object(l.a)(Object(l.a)({},t),{},{uuid:e.props.rows.uuid,inspec_unit:window.$fn.filterSelect(e.state.submit[1].data,t.inspec_unit_id,"name","value")}),n="sp-customer-log/edit",s="\u7f16\u8f91"),m.submit(null,n,{param:a,submitLoading:"infoLoading"}).then((function(t){h.then((function(e){return e.default.success("".concat(s,"\u6210\u529f"))})),e.clears(),e.props.close&&e.props.close()}))},init:function(t){return e.form=t}})})}}]),a}(p.a.Component)}}]);
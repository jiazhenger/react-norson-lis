(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[254],{138:function(e,t,n){"use strict";var a=Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(22)]).then(n.bind(null,143)),i=Promise.all([n.e(0),n.e(2),n.e(1),n.e(14)]).then(n.bind(null,123)),c=window.$fn;t.a={interfaceConfirm:function(e,t,n,c){t?a.then((function(a){a.default({msg:"\u662f\u5426\u786e\u8ba4".concat(t,"\uff1f"),onOk:function(a){window.$http.submit(null,e,{param:n}).then((function(e){i.then((function(e){return e.default.success("".concat(t,"\u6210\u529f"))})),c(),a()}))}})})):window.$http.submit(null,e,{param:n}).then((function(e){i.then((function(e){return e.default.success("".concat(t,"\u6210\u529f"))})),c()}))},sysTime:function(e,t){var n=c.getUser(),a="9";a=c.hasObject(n)?t||(n.timeline_node?n.timeline_node:"9"):t||"9";var i=parseInt(a)>9?"".concat(a,":00:00"):"0".concat(a,":00:00"),o=new Date;o.getHours()<Number(a)?1===e&&o.setTime(o.getTime()-864e5):2===e&&o.setTime(o.getTime()+864e5);var l=o.getFullYear(),r=o.getMonth()+1>9?o.getMonth()+1:"0".concat(o.getMonth()+1),s=o.getDate()>9?o.getDate():"0".concat(o.getDate()),u=o.getHours()>9?o.getHours():"0".concat(o.getHours()),d=o.getMinutes()>9?o.getMinutes():"0".concat(o.getMinutes()),m=o.getSeconds()>9?o.getSeconds():"0".concat(o.getSeconds());return i?"".concat(l,"-").concat(r,"-").concat(s," ").concat(i):"".concat(l,"-").concat(r,"-").concat(s," ").concat(u,":").concat(d,":").concat(m)},intervalTime:function(e,t){var n=new Date,a=n;e&&(a=new Date(n.getTime()-24*e*60*60*1e3));var i=a.getFullYear(),c=a.getMonth()+1>9?a.getMonth()+1:"0".concat(a.getMonth()+1),o=a.getDate()>9?a.getDate():"0".concat(a.getDate()),l=a.getHours()>9?a.getHours():"0".concat(a.getHours()),r=a.getMinutes()>9?a.getMinutes():"0".concat(a.getMinutes()),s=a.getSeconds()>9?a.getSeconds():"0".concat(a.getSeconds());return t?"".concat(i,"-").concat(c,"-").concat(o," ").concat(t):"".concat(i,"-").concat(c,"-").concat(o," ").concat(l,":").concat(r,":").concat(s)},img_domain_url:function(e){if(e){var t=c.local("user");return t&&Object.keys(t).length>0&&t.img_domain?t.img_domain+e:e}return""},exportExcel:function(e){var t=e.api,n=e.apiType,a=e.param,i=e.cb;window.$http[n||"pull"](null,t,a).then((function(e){window.location.href=e.url,i&&i()}))},switchFlag:function(e){return e?1:0},flagSwitch:function(e){return"1"===String(e)}}},479:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var a=n(5),i=n(2),c=n(22),o=n(23),l=n(27),r=n(25),s=n(24),u=n(0),d=n.n(u),m=(n(138),window),f=m.$http,h=m.$fn,p=m.$async,g=(p((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(13)]).then(n.bind(null,94))})),Promise.all([n.e(0),n.e(2),n.e(1),n.e(14)]).then(n.bind(null,123))),_=Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(22)]).then(n.bind(null,143)),b=p((function(){return n.e(5).then(n.bind(null,135))})),w=p((function(){return n.e(6).then(n.bind(null,137))})),y=p((function(){return Promise.all([n.e(0),n.e(1),n.e(4),n.e(11)]).then(n.bind(null,133))})),j=p((function(){return n.e(106).then(n.bind(null,424))})),v=p((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(12),n.e(86)]).then(n.bind(null,426))})),O=n.e(9).then(n.bind(null,144)),x=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={data:[],pag:{},selectedKeys:[],laboratoryOption:[],project_name:""},e.forms=[{label:"\u6807\u672c\u6761\u7801",name:"spec_code",type:"input"},{label:"\u5b9e\u9a8c\u53f7",name:"experiment_num",type:"input"},{label:"\u533b\u9662",name:"hosp_id",type:"select",data:[],nameStr:"name",idStr:"value"},{label:"\u75c5\u4eba\u59d3\u540d",name:"patient_name",type:"input"},{label:"\u9879\u76ee\u540d\u79f0",name:"kind_name",type:"input"},{label:"\u63a5\u6536\u65f6\u95f4",name:"date1",type:"date-range",names:["ck_start_date","ck_end_date"]},{label:"\u68c0\u6d4b\u65f6\u95f4",name:"date2",type:"date-range",names:["ts_start_date","ts_end_date"]},{label:"\u62a5\u544a\u65f6\u95f4",name:"date3",type:"date-range",names:["rp_start_date","rp_end_date"]},{label:"\u5c97\u4f4d",name:"project_name_id",type:"select",data:[],nameStr:"name",idStr:"value"},{label:"\u8eab\u4efd\u8bc1",name:"card_no",type:"input"}],e.model={},e.fetch=function(t){return h.fetch.call(Object(l.a)(e),"specimen/views",Object(i.a)(Object(i.a)({},t),{},{project_name:e.state.project_name}))},e.cols=[{title:"\u6807\u672c\u6761\u7801",field:"spec_code",width:120},{title:"\u533b\u9662\u540d\u79f0",field:"hosp_name",width:240},{title:"\u81ea\u7136\u9879\u76ee",field:"parent_kind_name",width:280},{title:"\u75c5\u4eba\u59d3\u540d",field:"patient_name",width:100},{title:"\u53d7\u68c0\u4eba\u7c7b\u578b",field:"case_type_name",width:100},{title:"\u5e74\u9f84",field:"age_first_val",width:100,render:function(e){var t=e.rows;return"".concat(t.age_first_val).concat(t.age_first_type_name).concat(t.age_second_val).concat(t.age_second_type_name)}},{title:"\u6027\u522b",field:"sex_name",width:70},{title:"\u9879\u76ee\u540d\u79f0",field:"kind_name",width:280},{title:"\u7ed3\u679c",field:"result",width:120},{title:"\u63d0\u793a",field:"tips",width:120},{title:"\u63a5\u6536\u65f6\u95f4",field:"receive_time",width:180},{title:"\u9879\u76ee\u7c7b\u578b",field:"kind_category_name",width:120},{title:"\u9879\u76ee\u4ee3\u7801",field:"kind_code",width:120},{title:"\u5b9e\u9a8c\u53f7",field:"experiment_num",width:120},{title:"\u5c97\u4f4d",field:"project_name",width:120},{title:"\u62a5\u544a\u65f6\u95f4",field:"rp_date",width:180},{title:"\u62a5\u544a\u72b6\u6001",field:"rp_status_name",width:100},{title:"\u72b6\u6001",field:"status_name",width:80,render:function(e){var t=e.rows;return"45006"===t.status?"\u5df2\u8fdf\u53d1":t.status_name}},{title:"\u9001\u68c0\u533b\u751f",field:"doctor",width:100},{title:"\u68c0\u6d4b\u65f6\u95f4",field:"ts_date",width:180},{title:"\u8eab\u4efd\u8bc1",field:"card_no",width:180},{title:"\u79d1\u5ba4",field:"department_name",width:120},{title:"\u5e8a\u53f7",field:"bed_no",width:100}],e.ButtonGroup=function(){return[{label:"\u5bfc\u51fa F2",code:"F2",onClick:function(){return e.Derivedform()}}]},e.Derivedform=function(){var t=Object(i.a)(Object(i.a)({},e.model),{},{project_name:e.state.project_name});_.then((function(n){n.default({msg:"\u662f\u5426\u786e\u8ba4\u5bfc\u51fa\uff1f",onOk:function(n){window.$http.pull(Object(l.a)(e),"specimen/viewsexport",{dataName:null,param:t}).then((function(e){e?window.location.href=e.url:g.then((function(e){return e.default.error("\u64cd\u4f5c\u5931\u8d25")})),n()}))}})}))},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;O.then((function(t){h.getCache({cache:t.default.BsHospitalSelect,name:"name",id:"value",callback:function(t){h.hasArray(t)?e.forms[2].data=t:f.submit(null,"bs-hospital/select").then((function(t){e.forms[2].data=t,h.setCache()}))}}),h.getCache({cache:t.default.laboratoryselect,name:"name",id:"value",callback:function(t){h.hasArray(t)?(e.setState({laboratoryOption:t}),e.forms[8].data=t):f.submit(null,"bs-hospital/select").then((function(t){e.setState({laboratoryOption:t}),e.forms[8].data=t,h.setCache()}))}})})),this.fetch()}},{key:"render",value:function(){var e=this,t=this.state,n=t.data,i=t.pullLoading,c=t.pag;return Object(a.jsxs)(b,{title:"\u5ba2\u670d\u67e5\u8be2",ButtonGroup:this.ButtonGroup(),children:[Object(a.jsx)(w,{data:this.forms,onChange:function(t,n){if(t.project_name_id){var a=window.$fn.filterSelect(e.state.laboratoryOption,t.project_name_id,"name","value");e.setState({project_name:a},(function(){h.onChange.call(e,t,n)}))}else h.onChange.call(e,t,n)},onSubmit:h.onSubmit.bind(this),onReset:h.onReset.bind(this,this.forms),loading:i}),Object(a.jsx)(y,{className:"xplr",cols:this.cols,data:n,loading:i,onRow:function(t){e.setState({selectedKeys:t}),e.QueryLogRef.fetch(t),e.QueryChild.changeInfo(t)},pag:c,onChange:function(t,n){return h.pageChange.call(e,{current:t,pageSize:n})}}),Object(a.jsxs)("div",{className:"fx ml10 mr10 mb10",style:{height:"350px"},children:[Object(a.jsx)("div",{className:"bor1 ex r4px rel",style:{minWidth:"660px",width:0},children:Object(a.jsx)(v,{onRef:function(t){return e.QueryChild=t}})}),Object(a.jsx)("div",{className:"bor1 ex r4px ml10 fx",children:Object(a.jsx)(j,{onRef:function(t){return e.QueryLogRef=t}})})]})]})}}]),n}(d.a.Component)}}]);
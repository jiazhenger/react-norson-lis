(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[248],{290:function(t,e,a){"use strict";var n=a(2),c=a(1),o=function(t){return(t=t.toString())[1]?t:"0"+t},l=function(t,e){return t.map(o).join(e)};e.a={full:function(t){var e=new Date(t);return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds()}},format:function(t,e){var a=Object(n.a)({s:"-",l:"en",t:"ymd"},e),o=null,s=null;if(s=c.a.isString(t)?this.getTime(t):t instanceof Date?t.getTime():t){var i=this.full(s);switch(a.t){case"full":o=l([i.year,i.month,i.day],a.s)+" "+l([i.h,i.m,i.s],":");break;case"ymd-hm":o=l([i.year,i.month,i.day],a.s)+" "+l([i.h,i.m],":")+":00";break;case"ymd":o="zh"===a.l?i.year+"\u5e74"+i.month+"\u6708"+i.day+"\u65e5":l([i.year,i.month,i.day],a.s);break;case"hms":o=l([i.h,i.m,i.s],":");break;case"hm":o=l([i.h,i.m],":")}}return o},getTime:function(t){return t?new Date(t).getTime():(new Date).getTime()},customDate:function(t,e,a){var n=new Date,c=n.getFullYear(),o=n.getMonth()+1>9?n.getMonth()+1:"0".concat(n.getMonth()+1),l=n.getDate()>9?n.getDate():"0".concat(n.getDate()),s=n.getHours()>9?n.getHours():"0".concat(n.getHours()),i=n.getMinutes()>9?n.getMinutes():"0".concat(n.getMinutes()),r=n.getSeconds()>9?n.getSeconds():"0".concat(n.getSeconds()),u="";if(1===t){var d=l-t>9?l-t:"0".concat(l-t);u=a?"".concat(c,"-").concat(o,"-").concat(d," ").concat(a):"start"===e?"".concat(c,"-").concat(o,"-").concat(d," 00:00:00"):"end"===e?"".concat(c,"-").concat(o,"-").concat(d," 23:59:59"):"".concat(c,"-").concat(o,"-").concat(d," ").concat(s,":").concat(i,":").concat(r)}else u=2===t?"date"===e?"".concat(c,"-").concat(o,"-01"):"".concat(c,"-").concat(o,"-01 00:00:00"):3===t?"date"===e?"".concat(c,"-").concat(o-1,"-").concat(l):"".concat(c,"-").concat(o-1,"-").concat(l," 00:00:00"):"current-date"===t?"".concat(c,"-").concat(o,"-").concat(l):"".concat(c,"-").concat(o,"-").concat(l," ").concat(s,":").concat(i,":").concat(r);return u}}},536:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return _}));var n=a(5),c=a(22),o=a(23),l=a(27),s=a(25),i=a(24),r=a(0),u=a.n(r),d=a(290),h=window,m=h.$http,f=h.$fn,g=h.$async,p=(g((function(){return Promise.all([a.e(0),a.e(2),a.e(1),a.e(3),a.e(13)]).then(a.bind(null,94))})),Promise.all([a.e(0),a.e(2),a.e(1),a.e(14)]).then(a.bind(null,123))),b=Promise.all([a.e(0),a.e(2),a.e(1),a.e(3),a.e(22)]).then(a.bind(null,143)),y=g((function(){return a.e(5).then(a.bind(null,135))})),v=g((function(){return a.e(6).then(a.bind(null,137))})),w=g((function(){return Promise.all([a.e(0),a.e(1),a.e(4),a.e(11)]).then(a.bind(null,133))})),S=g((function(){return Promise.all([a.e(0),a.e(2),a.e(1),a.e(3),a.e(81)]).then(a.bind(null,433))})),_=function(t){Object(s.a)(a,t);var e=Object(i.a)(a);function a(){var t;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))).state={data:[],pag:{},selectedKeys:[],data1:{}},t.forms=[{label:"\u8d26\u671f",name:"bill_phase_id",type:"select",data:[]},{label:"\u63a5\u6536\u6807\u672c\u65e5\u671f",name:"date",names:["start_at","end_at"],type:"date-range"},{label:"\u533a\u57df\u540d\u79f0",name:"region_id",type:"select",data:[]},{label:"\u5ba2\u6237\u540d\u79f0",name:"hosp_id",type:"select",data:[]}],t.model={start_at:d.a.customDate(2,"date"),end_at:d.a.customDate("current-date")},t.fetch=function(e){return f.fetch.call(Object(l.a)(t),"bill-hosp/wait",e)},t.cols=[{type:"checkbox"},{title:"\u533a\u57df\u540d\u79f0",field:"region_name",width:160},{title:"\u5ba2\u6237\u540d\u79f0",field:"hosp_name",width:170},{title:"\u8d26\u671f",field:"phase_name",width:170},{title:"\u6807\u672c\u6570\u91cf",field:"num",width:160},{title:"\u6807\u51c6\u603b\u4ef7",field:"sum_sprice",width:160},{title:"\u5b9e\u9645\u603b\u4ef7",field:"sum_price",width:170}],t.ButtonGroup=function(){return[{label:"\u6279\u91cf\u7ed3\u7b97",ghost:!0,disabled:0===t.state.selectedKeys.length,onClick:function(){b.then((function(e){e.default({msg:"\u662f\u5426\u786e\u8ba4\u6279\u91cf\u7ed3\u7b97\uff1f",onOk:function(e){var a=t.state.data1.map((function(t){return t.hosp_id})),n=t.state.data1.map((function(t){return t.bill_phase_id}));m.submit(null,"bill-hosp/settlement",{param:{hosp_ids:a.join(","),bill_phase_id:n}}).then((function(a){p.then((function(t){return t.default.success("\u6279\u91cf\u7ed3\u7b97\u6210\u529f")})),t.fetch(t.model),e()}))}})}))}}]},t}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var t=this;f.dataSave("bill-phase-select-data").then((function(e){f.hasArray(e)?t.forms[0].data=e:m.pull(null,"bill-phase/select",{dataName:null}).then((function(e){console.log(e),t.forms[0].data=e.items,f.dataSave("bill-phase-select-data",e)}))})),f.dataSave("bs-area-select").then((function(e){f.hasArray(e)?t.forms[2].data=e:m.pull(null,"bs-area/select",{dataName:null}).then((function(e){console.log(e),t.forms[2].data=e.items,f.dataSave("bs-area-select",e)}))})),f.dataSave("device").then((function(e){f.hasArray(e)?t.forms[3].data=e:m.pull(null,"bs-hospital/select",{dataName:null}).then((function(e){t.forms[3].data=e.items,f.dataSave("device",e)}))})),this.fetch()}},{key:"render",value:function(){var t=this,e=this.state,a=e.data,c=e.data1,o=e.pullLoading,l=e.pag;e.selectedKeys;return Object(n.jsxs)(y,{title:"\u8d26\u5355\u7ed3\u7b97",ButtonGroup:this.ButtonGroup(),children:[Object(n.jsx)(v,{data:this.forms,onChange:function(e,a){return f.onChange.call(t,e,a)},onSubmit:f.onSubmit.bind(this),onReset:f.onReset.bind(this,this.forms),loading:o,init:function(t){t.setFieldsValue({date:[d.a.customDate(2,"date"),d.a.customDate("current-date")]})}}),Object(n.jsx)(w,{className:"xplr",cols:this.cols,data:a,loading:o,onRow:function(e){console.log(e),t.setState({data1:e}),t.setState({selectedKeys:e})},pag:l,onChange:function(e,a){return f.pageChange.call(t,{current:e,pageSize:a})},onSort:function(e){return f.onSort.call(t,e)}}),Object(n.jsx)(S,{className:"fv rel ex xplr",model:this.model,rowdata:c||[]})]})}}]),a}(u.a.Component)}}]);
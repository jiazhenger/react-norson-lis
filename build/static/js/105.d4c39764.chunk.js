(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[105],{422:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var s=n(5),a=n(2),r=n(22),o=n(23),c=n(27),i=n(25),l=n(24),u=n(0),f=n.n(u),d=window,m=d.$http,h=d.$fn,p=d.$async,b=p((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(13)]).then(n.bind(null,94))})),j=Promise.all([n.e(0),n.e(2),n.e(1),n.e(14)]).then(n.bind(null,123)),g=p((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(17)]).then(n.bind(null,146))})),v=p((function(){return Promise.all([n.e(0),n.e(1),n.e(4),n.e(11)]).then(n.bind(null,133))})),y=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))).state={data:[],pag:{},selectedKeys:[],forms:{},keys:0},e.model={},e.fetch=function(t){return m.paging(Object(c.a)(e),"shelf/myshelf",{param:Object(a.a)(Object(a.a)({},t),{},{pageSize:e.pageSize},e.state.forms),loading:!1})},e.cols=[{title:"\u6807\u672c\u67b6\u7f16\u53f7",field:"sf_number",width:100},{title:"\u79d1\u5ba4",field:"project_name",width:120},{title:"\u5bb9\u91cf",field:"total_capacity",width:100},{title:"\u5df2\u4f7f\u7528\u91cf",field:"use_capacity",width:100},{title:"\u64cd\u4f5c",align:"tc",width:100,render:function(t){var n=t.rows;return Object(s.jsx)(b,{label:"\u4e0a\u67b6\u5b8c\u6210",ghost:!0,onClick:function(){return e.onCompletion(n.sf_number)}})}}],e.onReset=function(){var t=e.state,n=t.forms,s=t.keys;n.sf_code="",n.sf_number="",n.project_name="",e.setState({forms:n,keys:s+1},(function(){e.fetch()}))},e.onChanges=function(t,n){var s=e.state.forms;s[n]=t,e.setState({forms:s})},e.pulldown=function(){var t=e.state,n=t.forms,s=t.keys;if(n.sf_code){var a={sf_code:n.sf_code};m.submit(Object(c.a)(e),"shelf/autouse",{param:a,submitLoading:"infoLoading"}).then((function(t){j.then((function(e){return e.default.success("\u64cd\u4f5c\u6210\u529f")})),n.sf_code="",e.setState({forms:n,keys:s+1}),e.fetch()}))}else j.then((function(e){return e.default.error("\u8bf7\u8f93\u5165\u6807\u672c\u67b6\u4ee3\u7801")}))},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.onRef(this),this.fetch()}},{key:"onCompletion",value:function(e){var t=this,n={sf_number:e};m.submit(this,"shelf/upshelfadded",{param:n,submitLoading:"infoLoading"}).then((function(e){j.then((function(e){return e.default.success("\u64cd\u4f5c\u6210\u529f")})),t.fetch(),t.props.onCompletes()}))}},{key:"onRow",value:function(e){this.setState({selectedKeys:e}),this.props.onCompletes({sf_number:e.sf_number,project_name:e.project_name,current:1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.forms,a=t.data,r=t.pullLoading,o=t.pag,c=t.keys;return Object(s.jsxs)(f.a.Fragment,{children:[Object(s.jsxs)("div",{className:"fx p10",children:[Object(s.jsxs)("div",{className:"ex fxw",children:[Object(s.jsxs)("div",{className:"mb5 mr10",children:["\u6807\u672c\u67b6\u4ee3\u7801\uff1a",Object(s.jsx)(g,{p:"\u8bf7\u8f93\u5165\u6807\u672c\u67b6\u4ee3\u7801",width:120,value:n.sf_code,style:{borderRadius:"4px"},className:"mlr5",onChange:function(t){return e.onChanges(t,"sf_code")},onPressEnter:function(){return e.pulldown()}}),Object(s.jsx)(b,{label:"\u9886\u53d6",ghost:!0,className:"mlr5",onClick:function(){return e.pulldown()}})]}),Object(s.jsxs)("div",{className:"mb5 mr10",children:["\u6807\u672c\u67b6\u7f16\u53f7\uff1a",Object(s.jsx)(g,{p:"\u8bf7\u8f93\u5165\u6807\u672c\u67b6\u7f16\u53f7",width:120,value:n.sf_number,style:{borderRadius:"4px"},onChange:function(t){return e.onChanges(t,"sf_number")},className:"mlr5"})]}),Object(s.jsxs)("div",{className:"mb5 mr10",children:["\u79d1\u5ba4\uff1a",Object(s.jsx)(g,{p:"\u8bf7\u8f93\u5165\u79d1\u5ba4",width:120,value:n.project_name,style:{borderRadius:"4px"},onChange:function(t){return e.onChanges(t,"project_name")},className:"mlr5"})]})]},c),Object(s.jsxs)("div",{children:[Object(s.jsx)(b,{label:"\u67e5\u8be2",ghost:!0,className:"mr10",onClick:function(){return e.fetch()}}),Object(s.jsx)(b,{label:"\u91cd\u7f6e",ghost:!0,onClick:function(){return e.onReset()}})]})]}),Object(s.jsx)(v,{className:"plr2",cols:this.cols,data:a,loading:r,onRow:function(t){return e.onRow(t)},pag:o,onChange:function(t,n){return h.pageChange.call(e,{current:t,pageSize:n})}})]})}}]),n}(f.a.Component)}}]);
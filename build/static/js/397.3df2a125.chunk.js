(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[397],{377:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return k}));var i=n(11),a=n.n(i),l=n(14),r=n(5),s=n(2),o=n(22),d=n(23),c=n(27),u=n(25),f=n(24),h=n(0),m=n.n(h),p=n(124),b=window,w=b.$http,j=b.$fn,v=b.$async,g=v((function(){return Promise.resolve().then(n.bind(null,94))})),_=v((function(){return Promise.all([n.e(4),n.e(8)]).then(n.bind(null,133))})),y=v((function(){return n.e(7).then(n.bind(null,142))})),O=n.e(10).then(n.bind(null,123)),x=v((function(){return n.e(302).then(n.bind(null,350))})),k=function(t){Object(u.a)(n,t);var e=Object(f.a)(n);function n(){var t;Object(o.a)(this,n);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return(t=e.call.apply(e,[this].concat(a))).state={data:[],pag:{},rowId:"",submit:[{label:"\u4f5c\u5e9f\u539f\u56e0",name:"remark",type:"textarea",width:400}]},t.forms=[],t.model={},t.statusList=[],t.options=[{label:"\u6b63\u5e38",value:"1"},{label:"\u51b2\u62b5",value:"2"}],t.fetch=function(e){return w.paging(Object(c.a)(t),"bill/speclists",{param:Object(s.a)(Object(s.a)({},e),{},{pageSize:t.pageSize},t.model),loading:!1})},t.cols=[{title:"\u8d26\u5355\u7f16\u53f7",field:"order_sn",width:120},{title:"\u8d26\u671f",field:"phase_str",width:120},{title:"\u8d26\u5355\u7c7b\u578b",field:"pay_type",width:80,render:function(e){var n=e.rows;return window.$fn.filterSelect(t.options,n.pay_type,"label","value")}},{title:"\u81ea\u7136\u9879\u76ee",field:"parent_kind_name",width:120},{title:"\u533b\u9662\u540d\u79f0",field:"hosp_name",width:120},{title:"\u9879\u76ee\u540d\u79f0",field:"kind_name",width:120},{title:"\u6807\u51c6\u4ef7\u683c",field:"sprice",width:80},{title:"\u6298\u6263\u7387",field:"percent",width:80},{title:"\u5b9e\u9645\u4ef7\u683c",field:"price",width:80},{title:"\u521b\u5efa\u65f6\u95f4",field:"created_at",width:120},{title:"\u8d26\u5355\u72b6\u6001",field:"status",width:80,render:function(e){var n=e.rows;return window.$fn.filterSelect(t.statusList,n.status,"name","value")}},{title:"\u4e1a\u52a1\u5458",field:"salesman_user",width:100},{title:"\u4e1a\u52a1\u5458\u72b6\u6001",field:"status_salesman_name",width:100},{title:"\u5907\u6ce8",field:"remark",width:120},{title:"\u64cd\u4f5c",field:"custom",width:180,render:function(e){var n=e.rows;return Object(r.jsxs)("div",{className:"plr5",children:[Object(r.jsx)(g,{label:"\u4f5c\u5e9f",ghost:!0,className:"ml15",onClick:function(){t.refs.modal.open();var e=t.state.submit;t.setState({rowId:n.uuid}),e[0].value="",t.setState({submit:e})}}),Object(r.jsx)(g,{label:"\u64cd\u4f5c\u8be6\u60c5",ghost:!0,className:"ml15",onClick:function(){t.refs.modal1.open(),t.setState({rowId:n.uuid})}})]})}}],t}return Object(d.a)(n,[{key:"getDataAsync",value:function(){var t=Object(l.a)(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.getDisItem({code:45300,callback:function(t){e.statusList=t}});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getDataAsync()}},{key:"componentWillReceiveProps",value:function(t){if(t.rowdata.length>0){var e=t.rowdata.length-1;this.model.hosp_id=t.rowdata[e].hosp_id,this.model.bill_phase_id=t.rowdata[e].bill_phase_id,this.model.status=t.rowdata[e].status,this.model.summary_sn=t.model.summary_sn,this.fetch(this.model)}}},{key:"render",value:function(){var t=this,e=this.state,n=e.data,i=e.pullLoading,a=e.pag,l=e.submit,o=e.rowId;return Object(r.jsxs)("div",{children:[Object(r.jsx)(p.a,{ref:"modal",title:"\u4f5c\u5e9f",width:648,noFooter:!0,children:Object(r.jsx)(y,{modal:!0,data:l,onChange:function(t,e,n){n.name,n.data},onSubmit:function(e){console.log(e),w.submit(null,"bill/del",{param:Object(s.a)({uuid:o},e)}).then((function(e){O.then((function(t){return t.default.success("\u6210\u529f")})),t.refs.modal.close(),t.fetch(t.model)}))},onClose:function(){return t.refs.modal.close()},init:function(e){return t.formSubmit=e}})}),Object(r.jsx)(p.a,{ref:"modal1",title:"\u64cd\u4f5c\u8be6\u60c5",width:900,noFooter:!0,children:Object(r.jsx)(x,{className:"fv rel ex xplr",bill_id:o})}),Object(r.jsx)(_,{className:"xplr",cols:this.cols,data:n,loading:i,pag:a,onChange:function(e,n){return j.pageChange.call(t,{current:e,pageSize:n})}})]})}}]),n}(m.a.Component)}}]);
(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[287],{459:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var a=n(5),c=n(22),l=n(23),i=n(27),s=n(25),o=n(24),r=n(0),d=n.n(r),u=window,h=u.$http,f=u.$fn,m=u.$async,b=m((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(13)]).then(n.bind(null,94))})),p=m((function(){return Promise.all([n.e(0),n.e(30)]).then(n.bind(null,204))})),y=m((function(){return n.e(5).then(n.bind(null,135))})),j=m((function(){return n.e(6).then(n.bind(null,137))})),k=n.e(9).then(n.bind(null,144)),v=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(e=t.call.apply(t,[this].concat(l))).state={data:[],pag:{},selectedKeys:[],inexecution:["numtype","gp_name"],codeChecked:!1,key:0,listData:[],codeSelect:[]},e.numtypeOption=[{name:"\u4e09\u8054",value:1},{name:"\u516d\u8054",value:2},{name:"\u4e5d\u8054",value:3}],e.forms=[{label:"\u5f53\u524d\u6761\u7801\u53f7",name:"spec_code",type:"input",readOnly:!0},{label:"\u751f\u6210\u6570\u91cf",name:"number",type:"input"},{label:"\u533b\u9662\u540d\u79f0",name:"gp_name",type:"select",data:[]},{label:"",name:"numtype",type:"select",data:e.numtypeOption}],e.model={number:"1",numtype:1},e.fetch=function(){var t={type:1,number:e.model.number,hospital_id:e.model.hospital_id};h.submit(Object(i.a)(e),"barcode/add",{param:t,submitLoading:"creatLoading"}).then((function(t){t.lists.forEach((function(e){e.rowChecked=!1})),e.setState({listData:t.lists,key:e.state.key+1}),e.form.setFieldsValue({spec_code:t.last_code})}))},e.getInfo=function(){h.submit(Object(i.a)(e),"barcode/info").then((function(t){e.form.setFieldsValue({spec_code:t.spec_code})}))},e.changeSelect=function(t,n){var a=e.state,c=a.listData,l=a.key;c.forEach((function(e){n.code===e.code&&(e.rowChecked=t)}));var i=c.filter((function(e){return e.rowChecked}));e.setState({listData:c,codeSelect:i,codeChecked:i.length===c.length,key:l+1})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;k.then((function(t){f.getCache({cache:t.default.BsHospitalSelect,name:"name",id:"value",callback:function(t){e.setState({data:t}),f.hasArray(t)?e.forms[2].data=t:h.submit(null,"bs-hospital/select").then((function(t){e.forms[2].data=t,f.setCache()}))}})}))}},{key:"allSelect",value:function(){var e=this,t=this.state,n=t.listData,a=t.codeChecked,c=t.key;n.forEach((function(t){t.rowChecked=!e.state.codeChecked}));var l=n.filter((function(e){return e.rowChecked}));this.setState({listData:n,codeSelect:l,codeChecked:!a,key:c+1})}},{key:"newarr",value:function(e,t){var n=e.filter((function(e){return e.code===t.code}));return!f.hasArray(n)}},{key:"deletes",value:function(){var e=this,t=this.state,n=t.listData,a=t.codeSelect,c=n.filter((function(t){return e.newarr(a,t)}));this.setState({listData:c,codeSelect:[],codeChecked:!1})}},{key:"empty",value:function(){var e=this.state.key;this.setState({listData:[],codeSelect:[],codeChecked:!1,key:e+1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.creatLoading,c=t.listData,l=t.codeChecked,i=t.key,s=t.codeSelect;return Object(a.jsxs)(y,{title:"\u6807\u672c\u6761\u7801",children:[Object(a.jsx)(j,{data:this.forms,onChange:function(t,n){return f.onChange.call(e,t,n,null,!0)},onSubmit:f.onSubmit.bind(this),loading:n,submitText:"\u751f\u6210 F4",init:function(t){e.form=t,t.setFieldsValue({number:"1",numtype:1}),e.getInfo()}}),Object(a.jsxs)("div",{className:"fx p10",style:{borderTop:"1px solid #F2F2F2"},children:[Object(a.jsxs)("div",{className:"ex",children:[Object(a.jsx)(p,{indeter:!1,disabled:!f.hasArray(c),value:l,onChange:function(t){return e.allSelect()},label:"\u5168\u9009"}),Object(a.jsxs)("span",{children:["\u9009\u62e9 ",s.length," \u6761"]})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)(b,{disabled:!f.hasArray(s),label:"\u5220\u9664",ghost:!0,onClick:function(){return e.deletes()}}),Object(a.jsx)(b,{label:"\u6e05\u7a7a",className:"ml10",ghost:!0,onClick:function(){return e.empty()}}),Object(a.jsx)(b,{disabled:!0,label:"\u6253\u5370",className:"ml10",ghost:!0})]})]},i),Object(a.jsx)("div",{className:"ex fxw pl10 pt5",style:{border:"1px solid #e8eaec",alignContent:"flex-start"},children:c.map((function(t,n){return Object(a.jsxs)("div",{className:"fx oh mt10 mr10",style:{width:"140px",height:"50px"},children:[Object(a.jsx)("div",{className:"ex tc",style:{lineHeight:"29px"},children:Object(a.jsx)(p,{value:t.rowChecked,onChange:function(n){return e.changeSelect(n,t)}})}),Object(a.jsxs)("div",{style:{width:"105px"},children:[Object(a.jsx)("div",{style:{height:"29px"},children:Object(a.jsx)("img",{style:{width:"100%",height:"100%"},src:t.img})}),Object(a.jsx)("div",{className:"tc f12",children:t.code})]})]},n)}))},i+1)]})}}]),n}(d.a.Component)}}]);
(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[327],{352:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var a=n(5),i=n(2),s=n(22),l=n(23),c=n(27),o=n(25),r=n(24),u=n(0),d=n.n(u),h=window,f=h.$http,m=h.$fn,p=h.$async,b=n.e(9).then(n.bind(null,144)),g=p((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(84)]).then(n.bind(null,288))})),v=p((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(12),n.e(19)]).then(n.bind(null,170))})),j=p((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(13)]).then(n.bind(null,94))})),_=Promise.all([n.e(0),n.e(2),n.e(1),n.e(14)]).then(n.bind(null,123)),O=p((function(){return Promise.all([n.e(0),n.e(1),n.e(4),n.e(11)]).then(n.bind(null,133))})),y=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).state={data:[],pullLoading:!1,selectedKeys:{},params:{},model:{},deviceNameOptions:[],keys:0},e.cols=[{title:"\u5b9e\u9a8c\u53f7",field:"lab_tag",width:80},{title:"\u7ed3\u679c\u65f6\u95f4",field:"msg_send_at",width:150},{title:"\u8bbe\u5907\u7f16\u53f7",field:"device_uid",width:100},{title:"\u8bbe\u5907\u540d\u79f0",field:"device_name",width:100},{title:"\u9879\u76ee",field:"kind_name",width:120},{title:"\u503c",field:"value",width:120},{title:"\u503c1",field:"value1",width:120}],e.changeFetch=function(t){e.setState({params:t},(function(){return e.fetch()}))},e.fetch=function(t){return m.fetch.call(Object(c.a)(e),"result-unit-item/getDeviceResultList",Object(i.a)(Object(i.a)(Object(i.a)({},t),e.state.params),e.state.model))},e.onChangesTime=function(t){console.log(t);var n=e.state.model;n.start_at=t.start,n.end_at=t.end,e.setState({date:[t.start,t.end],model:n}),console.log(e.state.model)},e.submits=function(t){if(!m.hasArray(e.state.data))return _.then((function(e){return e.default.error("\u6682\u65e0\u6570\u636e")}));var n={uuid:e.props.infos.uuid,result_suggestion_content:e.props.infos.result_suggestion_content,spec_abnormal:"",content:"",dilution_multiple:e.props.infos.dilution_multiple,result:e.state.selectedKeys.value,spec_type:e.props.infos.spec_type},a={forms:JSON.stringify([n])};f.submit(null,"result-unit-item/updateall",{param:a,onSuccess:function(){_.then((function(e){return e.default.success("\u64cd\u4f5c\u6210\u529f")})),t&&t()}})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.onRef&&this.props.onRef(this),b.then((function(t){var n=t.default;m.getCache({cache:n.deviceResult4Select,callback:function(t){m.hasArray(t)?e.setState({deviceNameOptions:t}):f.submit(null,"result-unit-item/getDeviceResult4Select").then((function(t){e.setState({deviceNameOptions:t}),m.setCache()}))}})}))}},{key:"onChanges",value:function(e,t){var n=this.state.model;n[t]=e[t],this.setState({model:n})}},{key:"render",value:function(){var e=this,t=this.state,n=t.data,i=t.pullLoading,s=t.pag,l=t.model,c=t.keys;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"fxj pb10",children:[Object(a.jsxs)("div",{children:["\u8bbe\u5907\u540d\u79f0\uff1a",Object(a.jsx)(v,{style:{marginRight:"20px"},name:"device_name",width:150,bordered:!0,data:this.state.deviceNameOptions,nameStr:"device_name",idStr:"device_name",value:l.spec_type,onChanged:function(t,n,a){return e.onChanges(t,a)}}),"\u7ed3\u679c\u65f6\u95f4\uff1a",Object(a.jsx)(g,{name:"date",names:["start_at","end_at"],width:380,range:!0,showTime:!0,value:this.state.date,onChange:function(t){return e.onChangesTime(t,!1,{})}})]},c),Object(a.jsxs)("div",{children:[Object(a.jsx)(j,{className:"mr10",label:"\u641c\u7d22",ghost:!0,onClick:function(){return e.fetch()}}),Object(a.jsx)(j,{label:"\u91cd\u7f6e",ghost:!0,onClick:function(){e.setState({model:{},date:[null,null],keys:c+1},(function(){e.fetch()}))}})]})]}),Object(a.jsx)(O,{cols:this.cols,data:n,loading:i,onRow:function(t){e.setState({selectedKeys:t})},pag:s,onChange:function(t,n){return m.pageChange.call(e,{current:t,pageSize:n})},onSort:function(t){return m.onSort.call(e,t)}})]})}}]),n}(d.a.Component)}}]);
(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[256],{138:function(e,t,n){"use strict";var a=Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(22)]).then(n.bind(null,143)),i=Promise.all([n.e(0),n.e(2),n.e(1),n.e(14)]).then(n.bind(null,123)),c=window.$fn;t.a={interfaceConfirm:function(e,t,n,c){t?a.then((function(a){a.default({msg:"\u662f\u5426\u786e\u8ba4".concat(t,"\uff1f"),onOk:function(a){window.$http.submit(null,e,{param:n}).then((function(e){i.then((function(e){return e.default.success("".concat(t,"\u6210\u529f"))})),c(),a()}))}})})):window.$http.submit(null,e,{param:n}).then((function(e){i.then((function(e){return e.default.success("".concat(t,"\u6210\u529f"))})),c()}))},sysTime:function(e,t){var n=c.getUser(),a="9";a=c.hasObject(n)?t||(n.timeline_node?n.timeline_node:"9"):t||"9";var i=parseInt(a)>9?"".concat(a,":00:00"):"0".concat(a,":00:00"),l=new Date;l.getHours()<Number(a)?1===e&&l.setTime(l.getTime()-864e5):2===e&&l.setTime(l.getTime()+864e5);var o=l.getFullYear(),s=l.getMonth()+1>9?l.getMonth()+1:"0".concat(l.getMonth()+1),u=l.getDate()>9?l.getDate():"0".concat(l.getDate()),r=l.getHours()>9?l.getHours():"0".concat(l.getHours()),d=l.getMinutes()>9?l.getMinutes():"0".concat(l.getMinutes()),m=l.getSeconds()>9?l.getSeconds():"0".concat(l.getSeconds());return i?"".concat(o,"-").concat(s,"-").concat(u," ").concat(i):"".concat(o,"-").concat(s,"-").concat(u," ").concat(r,":").concat(d,":").concat(m)},intervalTime:function(e,t){var n=new Date,a=n;e&&(a=new Date(n.getTime()-24*e*60*60*1e3));var i=a.getFullYear(),c=a.getMonth()+1>9?a.getMonth()+1:"0".concat(a.getMonth()+1),l=a.getDate()>9?a.getDate():"0".concat(a.getDate()),o=a.getHours()>9?a.getHours():"0".concat(a.getHours()),s=a.getMinutes()>9?a.getMinutes():"0".concat(a.getMinutes()),u=a.getSeconds()>9?a.getSeconds():"0".concat(a.getSeconds());return t?"".concat(i,"-").concat(c,"-").concat(l," ").concat(t):"".concat(i,"-").concat(c,"-").concat(l," ").concat(o,":").concat(s,":").concat(u)},img_domain_url:function(e){if(e){var t=c.local("user");return t&&Object.keys(t).length>0&&t.img_domain?t.img_domain+e:e}return""},exportExcel:function(e){var t=e.api,n=e.apiType,a=e.param,i=e.cb;window.$http[n||"pull"](null,t,a).then((function(e){window.location.href=e.url,i&&i()}))},switchFlag:function(e){return e?1:0},flagSwitch:function(e){return"1"===String(e)}}},508:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C}));var a=n(5),i=n(22),c=n(23),l=n(27),o=n(25),s=n(24),u=n(0),r=n.n(u),d=n(138),m=window,h=m.$http,f=m.$fn,b=m.$async,_=b((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(13)]).then(n.bind(null,94))})),k=b((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(3),n.e(17)]).then(n.bind(null,146))})),g=b((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(12),n.e(19)]).then(n.bind(null,170))})),p=Promise.all([n.e(0),n.e(2),n.e(1),n.e(14)]).then(n.bind(null,123)),j=b((function(){return n.e(15).then(n.bind(null,176))})),v=b((function(){return n.e(5).then(n.bind(null,135))})),w=b((function(){return n.e(33).then(n.bind(null,298))})),y=(b((function(){return n.e(7).then(n.bind(null,142))})),b((function(){return Promise.all([n.e(0),n.e(1),n.e(4),n.e(11)]).then(n.bind(null,133))}))),O=n.e(9).then(n.bind(null,144)),x=[{value:"2",name:"\u5f00\u542f"},{value:"1",name:"\u5ba1\u6838"},{value:"0",name:"\u8349\u7a3f"},{value:"-1",name:"\u672a\u5f00\u542f"},{value:"-2",name:"\u9884\u6dfb\u52a0"}],C=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,o=new Array(c),s=0;s<c;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={data:[],pag:{},selectedKeys:[],submit:[{label:"\u9879\u76ee\u4e2d\u6587\u540d\u79f0",name:"kind_name",title:"\u9879\u76ee\u4fe1\u606f"},{label:"\u4e2d\u6587\u7b80\u79f0",name:"short_name"},{label:"\u9879\u76ee\u82f1\u6587\u540d\u79f0",name:"name_en"},{label:"\u82f1\u6587\u7b80\u79f0",name:"name_short_en"},{label:"\u7ec4\u5408\u9879\u76ee\u4ee3\u7801",name:"kind_code"},{label:"\u9879\u76ee\u52a9\u8bb0\u7801",name:"debit_code"},{label:"\u7ed1\u5b9a\u533b\u9662",name:"hosp_id",type:"select",data:[]}],projectData:[],uuid:"",forms:{kind_name:"",short_name:"",name_en:"",name_short_en:"",kind_code:"",debit_code:"",report_id:"",spec_type:"",superiorquality:"",memo:"",sort:"",printing:"",result_formula:[],report_time_set:[{start_at:"",end_at:"",postpone:0,week_at:[],date_at:[],selectDayType:1}],project_id:"",low_board_id:"",tag_id:"",careful:"",remark:""}},e.kind_status=f.query("kind_status"),e.kind_id=f.query("id"),e.kind_rel_id="",e.model={kind_id:e.kind_id,keyword:""},e.fetch=function(t){return f.fetch.call(Object(l.a)(e),"kd-market-rel/index",t)},e.cols=[{type:"checkbox",width:40},{title:"\u9879\u76ee\u4ee3\u7801",field:"kind_code",width:120},{title:"\u9879\u76ee\u540d\u79f0",field:"kind_name",width:160},{title:"\u7b80\u79f0",field:"short_name",width:120},{title:"\u68c0\u6d4b\u65b9\u6cd5",field:"check_method_name",width:160},{title:"\u9879\u76ee\u5c5e\u6027",field:"kind_type_name",width:160},{title:"\u4ef7\u683c",field:"total_price",width:120},{title:"\u72b6\u6001",field:"kind_status",width:100,render:function(e){var t=e.rows,n=x.filter((function(e){return e.value===t.kind_status}));return f.hasArray(n)?n[0].name:Object(a.jsx)(j,{value:null})}}],e.ButtonGroup=function(){var t=[{label:"\u4fdd\u5b58",onClick:function(){e.saveData()}},{label:"\u5ba1\u6279",onClick:function(){h.submit(null,"kd-market/audit",{param:{kind_id:e.kind_id}}).then((function(e){p.then((function(e){return e.default.success("\u5ba1\u6279\u6210\u529f")}))}))}},{label:"\u4fdd\u5b58\u5e76\u63d0\u4ea4\u5ba1\u6279",onClick:function(){e.saveData("audit")}},{label:"\u53d1\u5e03",onClick:function(){h.submit(null,"kd-market/push",{param:{kind_id:e.kind_id}}).then((function(t){p.then((function(e){return e.default.success("\u53d1\u5e03\u6210\u529f")})),f.push(Object(l.a)(e),f.getRoot().root+"system-settings/project-settings")}))}},{label:"\u53d6\u6d88",ghost:!0,onClick:function(){f.back(Object(l.a)(e))}}],n=[{label:"\u4e0b\u67b6",onClick:function(){h.submit(null,"kind-info/off",{param:{kind_id:e.kind_id}}).then((function(t){p.then((function(e){return e.default.success("\u4e0b\u67b6\u6210\u529f")})),f.push(Object(l.a)(e),f.getRoot().root+"system-settings/project-settings/marketing?id=".concat(e.kind_id,"&kind_status=0"))}))}},{label:"\u8fd4\u56de",ghost:!0,onClick:function(){f.back(Object(l.a)(e))}}];return"0"===e.kind_status||"1"===e.kind_status?t:n},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.state.submit;O.then((function(n){var a=n.default;f.getCache({cache:a.BsHospitalSelect,callback:function(n){f.hasArray(n)?(t[6].data=n,e.setState({submit:t})):h.submit(null,f.replaceApi(a.BsHospitalSelect)).then((function(n){t[6].data=n,e.setState({submit:t}),f.setCache()}))}}),f.getCache({cache:a.kindItemSelect,callback:function(t){f.hasArray(t)?e.setState({projectData:t}):h.submit(null,f.replaceApi(a.kindItemSelect)).then((function(t){e.setState({projectData:t}),f.setCache()}))}})})),this.fetch(this.model),this.getProjectInfo(this.model)}},{key:"getProjectInfo",value:function(e){var t=this,n=this.state.submit;h.submit(null,"kd-market/info",{param:e}).then((function(e){f.setSubmitValues(n,e,(function(){t.setState({submit:n})}))}))}},{key:"getFieldValue",value:function(e){return this.form.getFieldValue(e)||""}},{key:"saveData",value:function(e){var t={kind_id:this.kind_id,kind_name:this.getFieldValue("kind_name"),name_en:this.getFieldValue("name_en"),short_name:this.getFieldValue("short_name"),name_short_en:this.getFieldValue("name_short_en"),debit_code:this.getFieldValue("debit_code"),hosp_id:this.getFieldValue("hosp_id")};e&&(t[e]=1),h.submit(null,"kd-market/edit",{param:t}).then((function(e){p.then((function(e){return e.default.success("\u64cd\u4f5c\u6210\u529f")}))}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.data,i=t.pullLoading,c=t.pag,l=(t.submit,t.projectData);return Object(a.jsxs)(v,{title:"\u8bbe\u5b9a\u6807\u51c6\u7ec4\u5408\u9879\u76ee",ButtonGroup:this.ButtonGroup(),children:[Object(a.jsxs)("div",{children:[Object(a.jsx)(w,{title:"\u9879\u76ee\u4fe1\u606f"}),Object(a.jsx)("div",{className:"fx"})]}),Object(a.jsxs)("div",{className:"fxmj",children:[Object(a.jsx)("h6",{className:"xmlr h40 b",children:"\u9879\u76ee\u660e\u7ec6"}),Object(a.jsxs)("div",{className:"fxm",children:[Object(a.jsxs)("div",{className:"fxm",children:[Object(a.jsx)(k,{size:"middle",className:"mr15",p:"\u8bf7\u8f93\u5165\u5173\u952e\u5b57",width:"100%",bordered:!1,onChange:function(t){return e.model.keyword=t}}),Object(a.jsx)(_,{label:"\u67e5\u8be2",ghost:!0,size:"small",className:"mr15 dkm",onClick:function(){e.fetch(e.model)}}),Object(a.jsx)(_,{label:"\u5220\u9664",ghost:!0,disabled:!this.state.selectedKeys.length,size:"small",className:"mr15 dkm",onClick:function(){var t={uuid:e.state.selectedKeys.map((function(e){return e.uuid}))};d.a.interfaceConfirm("kd-market-rel/delete","\u5220\u9664",t,(function(){e.fetch(e.model)}))}})]}),Object(a.jsxs)("div",{className:"fxm",children:[Object(a.jsx)(g,{size:"middle",p:"\u8bf7\u9009\u62e9\u9879\u76ee",data:l,width:200,bordered:!1,onChanged:function(t){return e.kind_rel_id=t}}),Object(a.jsx)(_,{label:"\u6dfb\u52a0",ghost:!0,size:"small",className:"ml15 dkm",onClick:function(){var t={kind_rel_id:e.kind_rel_id,kind_id:e.kind_id};e.kind_rel_id?h.submit(null,"kd-market-rel/add",{param:t}).then((function(t){p.then((function(e){return e.default.success("\u64cd\u4f5c\u6210\u529f")})),e.fetch(e.model)})):p.then((function(e){return e.default.error("\u8bf7\u9009\u62e9\u9879\u76ee")}))}})]})]})]}),Object(a.jsx)(y,{cols:this.cols,data:n,loading:i,onRow:function(t){return e.setState({selectedKeys:t})},pag:c,onChange:function(t,n){return f.pageChange.call(e,{current:t,pageSize:n})}})]})}}]),n}(r.a.Component)}}]);
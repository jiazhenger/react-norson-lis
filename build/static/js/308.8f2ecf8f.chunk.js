(this["webpackJsonpreact-my"]=this["webpackJsonpreact-my"]||[]).push([[308],{552:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return g}));var r=a(5),n=a(11),l=a.n(n),i=a(2),o=a(14),s=a(22),u=a(23),c=a(25),m=a(24),f=a(0),b=a.n(f),d=window,_=d.$http,h=d.$fn,p=d.$async,y=Promise.all([a.e(0),a.e(2),a.e(1),a.e(14)]).then(a.bind(null,123)),F=p((function(){return a.e(5).then(a.bind(null,135))})),w=p((function(){return a.e(7).then(a.bind(null,142))})),v=[{value:"0",name:"\u6570\u5b57"},{value:"1",name:"\u5b57\u6bcd"}],x=[{name:"\u5e74",value:"Y"},{name:"\u6708",value:"M"},{name:"\u65e5",value:"D"},{name:"\u5e74\u6708",value:"YM"},{name:"\u5e74\u65e5",value:"YD"},{name:"\u6708\u65e5",value:"MD"},{name:"\u6570\u503c",value:"INT"}],g=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={department:[],submit:[],id:h.query("id"),model:{}},e.forms=[{label:"\u5b9e\u9a8c\u53f7\u6a21\u677f\u540d\u79f0",name:"lab_name",required:!0},{label:"\u52a8\u6001\u524d\u7f00",name:"prefix_auto",type:"select",data:[],title:"\u524d\u7f00\u914d\u7f6e"},{label:"\u524d\u7f00\u503c\u8d77\u59cb\u503c",name:"prefix_int_start",prefix:"INT"},{label:"\u524d\u7f00\u503c\u7ed3\u675f\u503c",name:"prefix_int_end",prefix:"INT"},{label:"\u524d\u7f00\u503c\u589e\u91cf",name:"prefix_int_inc",prefix:"INT"},{label:"\u524d\u7f00\u4f4d\u6570",name:"lab_rule_start_type",required:!0,title:"\u5176\u4ed6\u914d\u7f6e"},{label:"\u7c7b\u578b",name:"start_type",required:!0,type:"select",data:[]},{label:"\u6570\u5b57\u7f16\u7801",name:"lab_rule_start",required:!0,disabled:!0,start_type:"0"},{label:"\u540e\u7f00\u4f4d\u6570",name:"lab_rule_end_type",required:!0},{label:"\u8d77\u59cb\u503c",name:"lab_rule_end",required:!0,disabled:!0},{label:"\u52a0\u6025\u524d\u7f00",name:"critical_prefix",required:!0},{label:"\u52a0\u6025\u8d77\u59cb\u503c",name:"critical_start",required:!0,disabled:!0},{label:"\u5468\u671f",name:"lab_cycle",required:!0,type:"select",data:[]},{label:"\u5468\u671f\u503c",name:"cycle_start",lab_cycle_number:""},{label:"\u5f00\u59cb\u65f6\u95f4",name:"cycle_start_time",type:"time",after:!0,lab_cycle_number:"43901"},{label:"\u7ed3\u675f\u65f6\u95f4",name:"cycle_end",type:"time",after:!0,lab_cycle_number:"43901"},{label:"\u63cf\u8ff0",name:"description",type:"textarea"}],e}return Object(u.a)(a,[{key:"getDataAsync",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.state.id)&&_.submit(null,"lis-lab-tag/info",{param:{uuid:t}}).then((function(e){var t=function(t){a.forms.forEach((function(a){"id"===t&&"uuid"===t&&"comp_id"===t&&"created_at"===t||a.name!==t||(a.value=e[t])}))};for(var r in e)t(r);setTimeout((function(){a.form.setFieldsValue(Object(i.a)({},e))}),200)})),this.showForm=this.forms,this.showForm.forEach((function(e){"prefix_auto"===e.name&&(e.data=x),"start_type"===e.name&&(e.data=v),"INT"!==e.prefix_auto&&(a.showForm=a.showForm.filter((function(e){return"INT"!==e.prefix}))),a.showForm=a.showForm.filter((function(e){return void 0===e.lab_cycle_number}))})),e.next=6,h.getDisItem({code:43900,callback:function(e){a.showForm.forEach((function(t){"lab_cycle"===t.name&&(t.data=e)}))}});case 6:setTimeout((function(){a.form&&("43901"===a.form.getFieldValue("lab_cycle")&&a.showForm.splice(a.showForm.length-1,0,a.forms[14],a.forms[15]),a.form.getFieldValue("lab_cycle")&&"43901"!==a.form.getFieldValue("lab_cycle")&&a.showForm.splice(a.showForm.length-1,0,a.forms[13]),"INT"===a.form.getFieldValue("prefix_auto")&&a.showForm.splice(2,0,a.forms[2],a.forms[3],a.forms[4]),a.showForm.forEach((function(e){a.form.getFieldValue("start_type")&&"lab_rule_start"===e.name&&("1"===a.form.getFieldValue("start_type")?e.label="\u5b57\u6bcd\u7f16\u7801":e.label="\u6570\u5b57\u7f16\u7801",e.disabled=!1),a.form.getFieldValue("lab_rule_end_type")&&("lab_rule_end"!==e.name&&"critical_start"!==e.name||(e.disabled=!1))}))),a.setState({submit:a.showForm})}),500);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getDataAsync()}},{key:"render",value:function(){var e=this,t=this.state,a=t.submit,n=t.id;return Object(r.jsx)(F,{title:"\u5b9e\u9a8c\u53f7\u6a21\u677f-\u8bbe\u7f6e\u89c4\u5219",children:Object(r.jsx)("div",{className:"ex fv xplr pt10",children:Object(r.jsx)(w,{data:a,btnSize:"large",okText:n?"\u4fee\u6539 Enter":"\u4fdd\u5b58 Enter",onChange:function(t,a,r){var n=r.name;r.data;"lab_cycle"===n&&(e.showForm.filter((function(e){return void 0!==e.lab_cycle_number})).length?"43901"===t?e.showForm.splice(e.showForm.length-2,1,e.forms[14],e.forms[15]):e.showForm.splice(e.showForm.length-3,2,e.forms[13]):"43901"===t?e.showForm.splice(e.showForm.length-1,0,e.forms[14],e.forms[15]):e.showForm.splice(e.showForm.length-1,0,e.forms[13]),e.setState({submit:e.showForm}));e.showForm.forEach((function(a){n===a.name&&(a.value=t),"prefix_auto"===n?("INT"===t?"INT"!==e.showForm[2].prefix&&e.showForm.splice(2,0,e.forms[2],e.forms[3],e.forms[4]):"INT"===e.showForm[2].prefix&&e.showForm.splice(2,3),e.setState({submit:e.showForm})):"start_type"===n?("lab_rule_start"===a.name&&(a.label="1"===t?"\u5b57\u6bcd\u7f16\u7801":"\u6570\u5b57\u7f16\u7801",a.disabled=!1),e.setState({submit:e.showForm})):"lab_rule_end_type"===n&&("lab_rule_end"!==a.name&&"critical_start"!==a.name||(a.disabled=!t),e.setState({submit:e.showForm}))}))},onSubmit:function(t){var a={prefix_int_end:"",prefix_int_inc:"",prefix_int_start:""};if(n){var r=Object(i.a)(Object(i.a)(Object(i.a)({},a),t),{},{uuid:n});_.submit(null,"lis-lab-tag/edit",{param:r}).then((function(t){y.then((function(e){return e.default.success("\u4fee\u6539\u6210\u529f")})),h.back(e)}))}else{var l=Object(i.a)(Object(i.a)({},a),t);_.submit(null,"lis-lab-tag/add",{param:l}).then((function(t){y.then((function(e){return e.default.success("\u6dfb\u52a0\u6210\u529f")})),h.back(e)}))}},onClose:function(){return h.back(e)},init:function(t){return e.form=t}})})})}}]),a}(b.a.Component)}}]);